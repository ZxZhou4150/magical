<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>MAGICAL visualization</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MAGICAL visualization</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(magical)</span></code></pre></div>
<div id="magical-visualzation" class="section level1">
<h1>MAGICAL visualzation</h1>
<p>MAGICAL offers several ways of visualizing circuits, all of which
make use of the package <code>karyoploteR</code>.</p>
<div id="read-the-results" class="section level2">
<h2>Read the results</h2>
<p>Let’s start by reading the results from the MAGICAL analysis,
“MAGICAL_selected_regulatory_circuits.txt”. We suggest running this demo
with our <a href="https://github.com/ZxZhou4150/magical/blob/R-package/tutorial/MAGICAL_selected_regulatory_circuits.txt">provided
file</a>, because as mentioned before, running MAGICAL can return very
similar but slightly different results each time.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># read the results</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;MAGICAL_selected_regulatory_circuits.txt&quot;</span>, <span class="at">header =</span> T, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="basic-visualization" class="section level2">
<h2>Basic visualization</h2>
<p>MAGICAL offers 3 ways of visualizing the circuits: by circuit index,
gene, or peak. For either of these ways, MAGICAL will plot a certain
region of one chromosome which includes the circuit(s). Basically, the
following information will be manifested on the plot:</p>
<ul>
<li>The chromosome id and coverage of the region</li>
<li>The <em>starting site</em> of the gene</li>
<li>The starting site and ending site of the peak</li>
<li>The top 3 (or less if there are less than 3) TFs that are most
likely to bind to the peak.</li>
</ul>
<p>Also, see the <a href="#advanced-options">advanced options</a>
section for the advanced visualization option of gene and peak track.
For this section, we are not showing them.</p>
<div id="visualize-by-circuit-index" class="section level3">
<h3>visualize by circuit index</h3>
<p>With function <code>plot_circuits_with_idx</code>, you can visualize
one circuit by its index.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># visualize the first circuit</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">plot_circuits_with_idx</span>(data, <span class="at">idx =</span> <span class="dv">1</span>, <span class="at">gene_track =</span> F, <span class="at">peak_track =</span> F)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="visualize-by-gene" class="section level3">
<h3>visualize by gene</h3>
<p>With function <code>plot_circuits_with_gene</code>, you can visualize
all circuits that contain a specific gene.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># visualize circuits with gene ACOT11</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">plot_circuits_with_gene</span>(data, <span class="at">gene =</span> <span class="st">&quot;ACOT11&quot;</span>, <span class="at">gene_track =</span> F, <span class="at">peak_track =</span> F)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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s+ylsvz2J1n2nY/LZ5nl5bJ8/kO70X92FQSAdfziH8zAf/53PzOD/+XnPzCD/pkxIIz5Z9aG8NlZEADW8Pzv/9OM9T++5BLP3D824QT49qff/tPH4bO7IACs4Y8vh/9CovQahFmPH/oIAH3l+Q/MZP97f3KH/v/75cIZAAGg7zz7G/Pxi5f9NcBLi9cACAD95tt//Jn5fPa9P83fBUIAgL6AACANAoA0CADSIABIgwAgDQKANNcLcHmSz6+YvnreUmUAds32Alye3EMA6AtbCzDJMgSA3rBOgCLLsoER4INhluXl5VufmaE/yUYTBIDesEaA4uDUjP7R5Yn51yxfnty/cOvXCZABJMHtBTBjv/53OsxjGgGgA9xeADPmgwC5+6iuBdYKsGV66x3uvID0atSDAtKr0UrWCPDKqfsXAShg7wXuRYCbnAEAusUm1wAIAL3lmrtAs4eDnQowzrIDO/MqRjGZm1ORTUwOTqfHrX3v5izU0C2kVcMlQTQ1S6qKCzUs7O32PdVwk+cAuxNg9shfd0wyF5mJ+fafn09//M/mC88Ok+i7hRr6haRquFhFn0yqile7uRzne6phWi/DXb4zNMqV06Mn8fhqBTj63JwGPnx0On3txG7dK4s1dAtJ1XCxij6ZVBUXali8n+2vhmkJYE8uRW4G/SQIMLbH16Onx+WXvzWRefXcHCmSqqFfSKqGi1X0yaSquFDDsRnue6thWgJYJiM79crqKfb06KtPvvj1VyYyH9mte62co1FDv5BcDReDOEmvis0g5nusYVoC2HbbcIQAuKSJzEXxwUdm3mgW9n/wmq+hX0iqhkuDmCdVxcUaDvZYw7QEsLcHYq9dvnthk3ZyeDF95dRG5nC49+nrYg2jAAnVcEkQU6viQg2LPdYwMQEAdgsCgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADSIABIgwAgDQKANAgA0iAASIMAIA0CgDQIANIgAEiDACANAoA0CADS/D9UBPIFY96NtAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># visualize circuits with gene ASAP3</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">plot_circuits_with_gene</span>(data, <span class="at">gene =</span> <span class="st">&quot;ASAP3&quot;</span>, <span class="at">gene_track =</span> F, <span class="at">peak_track =</span> F)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="visualize-by-peak" class="section level3">
<h3>visualize by peak</h3>
<p>With function <code>plot_circuits_with_peak</code>, you can visualize
all circuits that contain a specific peak.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># visualize circuits with peak chr4:184817550-184818412</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">plot_circuits_with_peak</span>(data, <span class="at">peak_chr =</span> <span class="st">&quot;chr4&quot;</span>, <span class="at">peak_start =</span> <span class="dv">184817550</span>, <span class="at">peak_end =</span> <span class="dv">184818412</span>, <span class="at">gene_track =</span> F, <span class="at">peak_track =</span> F)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="advanced-options" class="section level2">
<h2>Advanced options</h2>
<p>All the 3 functions offer an advanced options, which allows you to
see <strong>all the genes and peaks</strong> around the circuit region.
This is useful if you want to see the specificity of the circuit(s) in
the context of the whole region, which is, the other genes/peaks are not
involved in the circuit(s).</p>
<div id="gene-track" class="section level3">
<h3>Gene track</h3>
<p>Gene track can be visualized by setting the parameter
<code>gene_track</code> to <code>TRUE</code> (default). After that, you
need another parameter, <code>TxDb</code>, to specify the reference
genome from which the function will query genes. Before that, you must
download the corresponding TXDb package from Bioconductor. For example,
if your reference genome is hg38, you need to download the package
<code>TxDb.Hsapiens.UCSC.hg38.knownGene</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">## Here our reference genome is hg38</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># if (!require(&quot;BiocManager&quot;, quietly = TRUE))</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#     install.packages(&quot;BiocManager&quot;)</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># BiocManager::install(&quot;TxDb.Hsapiens.UCSC.hg38.knownGene&quot;)</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">library</span>(TxDb.Hsapiens.UCSC.hg38.knownGene)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co"># visualize the first circuit with gene track</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">plot_circuits_with_idx</span>(data, <span class="dv">1</span>, <span class="at">gene_track =</span> T, <span class="at">TxDb =</span> TxDb.Hsapiens.UCSC.hg38.knownGene, <span class="at">peak_track =</span> F)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAABd1BMVEUAAAAAADoAAGYAAP8AOjoAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtaWlpmAABmADpmAGZmOgBmOjpmOmZmOpBmZjpmZmZmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZjqQZpCQkDqQkGaQkLaQtpCQ29uQ2/+2ZgC2Zjq2kDq2kGa2kJC225C229u22/+2/7a2/9u2//++vr6+vsm+vtS+yd++1OrAvtDBvsbBxc3BzerGwb7Gxb7IvtTIycbIz8jJvr7JvsnJvtTJxsnJyM/JycnJydXJyd/J1OrJ3+LJ3/TQvtTUvr7UvsnUvtTUyd/U1NTU6v/bkDrbkGbbtmbbtpDb25Db29vb2//b/7bb/9vb///fyb7fycnfydTf1N/f3+rf9P/q1L7q9P/q///038n09N/0/+r0////AAD/tmb/25D/27b/29v/6tT/9NX/9N//9Or//7b//9v//+r///T///9QJYHkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAASAElEQVR4nO2diWMj5XmHx25ssTUmrvACARYqLaVJkEzTUjRlnTS9kx5b58ITQssqSbvumi4SdTfS7vzx+a45JEu2ZF0/yc+DkeabQ/Pqm8fvd4zkjVIAYaJVBwBwFQgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CDozv3ojira++VGadivbrbF7uY3/d1QLxd7hTjuJXKkZVZcR5pqCoLNyFDm2GtcL2q9Htby4mzbNMWn6WYSgV4CgM9KJtv7YZNFKtNO+dt+SoJ2o2q8bn/vWbwQdD4LOhnHO6ZWYNt4myd7h1rcr2x+ln1Wi6Jtt05JbJTvRdsts/LhuZLRJtl/3WTfaeVSPvvGHCHoFCDob3Yprp8OyFdR6Z7qXzr/2tYLef+dRHUGvAEFno9zvDILutv/TPFaduwOClvqgpTFSH0GvAkFnY4SgtdLacYK6MZLfB0GvBEFn43ITb8ud6EpBiya+jaDXgKCzkenVefkvSoJek0ERdHIQdEaSYpqpENR4+Uftr1+3U0mmS/p1vRDUu2hnmDr5MoJeAYLOyuBEvRc09aN4k0abUVhySbXp9gtjpNA3QNArQdCZ+dXrpVudQVA/D2rW9f8kivb/LBO0+3q0bVaaPavZGAlBrwZBQRoEBWkQFKRBUJAGQUEaBAVpbqOgSa1Y7h6EBXt3Z6edNv1EZVE0Zb/spjardo09vPday8127qbZmvGHmB2r4RC/3j4ytTQZCBoWOla1Wmen3XGfPPbF/v1GvmwW+u+3zbIVzd1sD4f4NeMPcZ9OTsuHJNlWuJbNF7T7ymHIc1X3uGsEtYa4BLjzudlqUt2emzU3G6rWtt6b7tPxSa33RiVyu3qpj1xyNTv0v9N/r5Umb0d+qxd07CHd/c+qqT8kzc6SNkmhE3ELBL3T8nnOmGHypclwyT2XNrv77TR55U7LrnFKday7aeaRLXaMt84ze7h/CN9xs3s1d72FxbfeRh5i9O1kh/hVtol/G0En4hYIamzsVEN3MLEdxMSnOGeN3XrUcH1E51s1T4dNnwfdbn75KHywzu7tMmgtvIhZ03RZeuQhWU/UC5rtkyDoRNwCQX0GDSK5DFpzqtkM2vlGJmi/7tJe1gcNxarNkX45dQ2/WxNs81k5WzP2kLDSHRL2Md3Wu41LkcIIboGgeR80qnUr0dZbNdPU71txTGrb/vNM0GY2SDejeONVXozyTX481fT9TpcOk6Jf67eMPqQkaHNgKgCu5xYIenD9PiALgoI0my8orDUICtJsrKDfG/5LNL6pL+bUUzs6Gig6Ou4rGnY45UY577p12ZSQ/SS8KW41EjvUb1bd4eE18m1uCr5pvxfvXuFOK9w2ci9pBkeJe3Sl3eGIYJhNFTSb4CkY0Rc9GjnV44zxe4e59Xzuvvvyt8zS0V7DTix1qsVdz/I2e7MzTCT167Xu3kEmqJs6cE9mF3sCt2d0xV8cg40V1E6cu/mfMMuUTTcZpbp7Ff+hju23GnmxX7dFd2hJUPPYcUmv5oXv7n9oct879nb70XcPSnc9B7Z1978wLxFm4rsHSW1Q0Jca4aWtoMUdUBjJpgpqhPIfzPDz9Gk2YW+N3G8bM3yOy4v2FtLdsqAV+1VMkyRNlv2PPPt29z8/SH/5gRXUeeZ2zQXNt3XsJ6LCR1K6B2anook36dL++abdoolH0CvZYEH9nUh/p9Ossd3Jju01hrubtdAH9cVmLW/xSxk0cX3FaknQR+99/P4jI2Hvtb80uw0Kmm0r7jmlX39kk/BuOYM6mjYun5UR9Eo2WNDhDGr88BnUGWk/s3G/EPRSBnVKerP3251wA90sJvfetS1zvWZviw4KGrYFQX0f1P2CNKOSoO5WarPmfnHIoNeysYIe7rSH+qB7ldAHdUbam5p7haBj+6DNwT5o2zTt/fsf1N1IfeeLQUHdtkzQbBRvu6qHxSjefWAlS8rNKoJew6YKmjPhjaTSx5hKDI/iYekgqGfMtzCG5kE3v7rkoMangupaNtT4VFBdy4Yanwqqa9lQ41NBdS0banwqqK5lQ41PxVyr69U5MM94JEHQKYhsdd2wxhak18Y7i6BTEHlFJ2cV4myYrAg6DVE0QX0JCSIUyk1B0Gm4TlBhFYRDuxIEnYqR1bVGaWptAs1B0NlYs8udsT5RI+gMrM9lHsV6BI+gN2U9ru816L8JBL0R+hd2crTfCoJOzybZ6RF+Pwg6LZunp0X2PSHolLwaq17KGRFVFEGnY2P9NG9t1QGMBEGnYoP9FDUUQadCtB2cE4pvDkGn4dWvFK/h3FB8cwg6DV999dWqQ1gkf7DqAEaAoNOAoEsHQacBQZcOgk4Dgi4dBJ0GBF06CDoNCLp0EHQaEHTpIOg0IOjSQdBpQNClg6DTgKBLB0GnAUGXDoKCNAgKOYoyKMYEq2GiP+yzbARDghWBoKDM1H+7bynoRQQrYpa/fro45AKC1aEog2JMsCIUZVCMCVaEogyKMcGKUJRBMSZYEYoyKMYEkIOgIA2C3lq6d1rmoRLZf4fc/aPlzZor1cxi77WW+xfKd9qrjhJBby3Nt6tG0P122r/fyAQ1T727jbQTbbfSzq5dteooEfS20nvzC5MmnaDvt0uCpkm1/53+ey23U4KgsCKMe+bHNerbLfcUeUE7JrEGQW0SXTEIekvpHUa2i2kzaJY6swxaywRtrt5PBL2tuORolLwkqB0fOUH79ZW37ymC3lbMwMg8dnY+t2377qVRvBW0GbkB/opBUJAGQUEaBAVpEBSkQVCQBkFBGgQFacYJ2jssz9LaD7b4KbFOFG01Fh8WgGciQft1I2US7Ro/zUIHQ2FpTCRot2ILyXarX7dpVOEWLdwSLguauHtfvcN7FXvXq3f32/azgRaTOXNTlxwl3FouCZqYBrx3WO0d2lZ9q9E7zD9U3dxudV9yd3CHBY0AbsINBDVuFs8mYWZlOzyqhu7npU7oqt8nrCk3ENQ34qEPah7yvmgnGyONEvT6112rVQoxqK5a8Amv3cc34pcF7bhZpnFN/BwjVFilEIPqqpULOjqDJn4WlEESLJnxfdCyoEnktWWaCZbMyFF8v747IGi3ko+UFj9RH76O3Qy3rHzRR2Anug4Wee6ZGQreLtTSdQn+UvT2G56rjn78PGhJ0MSPuWzUycJvdfqvY/uvJOTF7svfMt2Koz31a3w5+N5rrXUJfjh6P/JYcfSaHxZJar03KtFuUezuf2gy0Tv3G91XDiPxHsZg8FbQNQp+IPru/mdG0NVGLymo+U22MwXZXw0wxe7+5wfpLz8wtXSnJfDnLq5iMPimzUHrE/xA9OZ3q7Py6BUFzQZhnWpe7O4/eu/j9x+ZWno3X6/JUPC2G7c+wQ9G73p2q45eT1D/dWxbE+7X2Be7++3k3rv2jwjtt5WT0FDwbqG6LsEPR++XVxy9nqDh69hN+9B7s90Mv8bt7ksNW0t7FeVu3FDwdsH2T9Yj+EvRZ4KuMno9QQFKIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0iAoSIOgIA2CgjQICtIgKEiDoCANgoI0CArSIChIg6AgDYKCNAgK0ixD0Gf/9tQ+vfh1HH/yxBT/MY5PTPn5z03hLP6rx2HZbj9xjw+epudxfJxtPYsD37cHnF645VP7MmZP93SahgPmHro/yZmN98wHZ07m1p7M/2zrRKgKc+Ge/chdFnsF7IXw13VuLE/Q5z810V988uT5zx6bd3eaXlhbLx48NT9++fzY6Vd+dFsvHnz54wdPzdZnf/NDVxO+Ctyrnp88e2jKP3vsD1hM6OcnL37zODVnsGHbk9m1dtUtJqsKK+i/PLR1n1WKu5bzY3mCXriUc35y7lPPi/9+8Vsj5Ym1LV9Oz/xOp+ef2oRoDrywj1/++Nhuffa3/3A6UlD7qp8uJoP6k5jn/zXnvDgu1r74r6fzP936kFWFFfThub0sz/7J/cb6azk/lifouctvFyfnWZ5zUp66J/dgG41PraDmzZ8duwMubGufXmRN/F//+8+fFIKGJv6he9VwwNxD9ycxZ7B9jQvfyPvexVzzxNqRVYUT9Lm7LM9/6nPEugqaZVD3/Lv/CYKeeNuyN+Wy6LF3zbhs0uePnpwfP/vnv7Obn/39ycXxYAY1Ty6DnvoDFhS64fkvnmZp49y1ZovoUKwRWVU4QVN/WVLfAq6roIN90PBGQh/ULx/bTo3r3Lj3b6xz+ppm/F9/8sSs+f8fPDYDphGCmrI/YEGhp0FQH/avEbSoCi+ovSzuOtpKWUNBbYt4fGkU795IGMWHZWOfG7Kf2CFhaET8eNHxw6D5gKDFKH4B4+pBQf2Ewmn2hm43Z/ko/qG/LOdx6brODeZBQRoE1cZNMoZ5V9fdPjvN2ox88vjBJs8nIKg2Z3ZeI0wxZoL6md8wkXy84b1hZUHjUeviuNgU2x/bOU3jvJjGI48bd4qR5xi9Ki6WYncW/5S/RBxeLoQx8qWn5fkv7PxrmHctCWpvHuQTjgsYHI4mvrQcD9Z4nI6+atnm7EJds18ZEUHjQrPBlSN2dE9peBwQ1C1lTHjeUStHr5pc0DjO3tGsGPfOw6DskyfuKT4NM7/5aCSbM5+dawLONsfFsnuP5eqfUNDJa0dJ0OGQM2uz/4KNpUJJxzgtClMJWn71NFNueHWcry6ftHTy0j5x8Ysya7XYuW97M8JPaw1k0Hw+x04bz4n4cl2MrJg4F7N4p/nziNrLC+WrOGH1yAt6Y6Y576KYtVpccjw7vSxofnfDTxvPiQXXxo3qR0lQmvgh/AdSLh586eddh0fxVtAwbTwf9Jv4fj2KotqYXb/XHiwn43acFwySxFj5IKlfN8717jZG7tl7E0FTBB1cXrKgnd2w0Iyiatrdq0Q7bb/s1u0me9stUzR7JVG082Et2b30egBzZVDQqmvka1bUpNbdb/fvN/xy6jKoEbJ7kJqVZpNx9N7BioJeA0r5oehwxXGeRMKW8H8aF5ll/EsuPCUr5vwRGTSpmfxo0qZxMT1q+OXUC1p1uXOr0bErkogEOhYEnRNDfdCq64g6/1IvqF9OM0HNT8ignah2NLq3CuXZwHxWoTxxm3efi6nTbPR/9Sxi9sJX7XfTgmSveWiaqelH8e7JC5qtSnuHOx+ajmkl2nqrZvPo9p/aTsBKgtZnhrnBVbLqahuByDzophGX2/H82sfFXZh8r2mb+MVJhKC3CfqgcwJBFwOCzgkEBWkQFKRBUJAGQUEaBAVpEBSkQVCQBkFBGgQFaRAUpEFQkAZBQRoEBWkQFKRBUJAGQUEaBAVpEBSkQVCQBkFBGgQFaRAUpEFQkAZBQRoEBWkQFKRBUJAGQUEaBAVpEBSkQVCQBkFBGgQFaRAUpEFQkAZBQRoEBWkQFKRBUJAGQUEaBAVpEBSkQVCQBkFBGgQFaRAUpEFQkAZBQRoEBWkQFKRBUJAGQUEaBAVpEBSkQVCQBkFBGgQFaRAUpEFQkAZBQRoEBWkQFKRBUJAGQUEaBAVpEBSkQVCQBkFBGgQFaRAUpEFQkAZBQRoEBWkQFKRBUJAGQUEaBAVpEBSkQVCQBkFBGgQFaRAUpEFQkAZBQRoEBWl+DwDGOf2gSvFtAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="peak-track" class="section level3">
<h3>Peak track</h3>
<p>By setting the parameter <code>gene_track</code> to <code>TRUE</code>
(default), you can see the density of peaks around the region. You also
need another input, <code>peaks</code>, which contains the chromosome,
start, and end of the peaks. File “scATAC peaks.txt” in our <a href="https://drive.google.com/file/d/1CerwMHMnS1PNFNMy00OoHQjn6T30M1j4/view?usp=sharing">demo
data</a> provides an example.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># read the peaks</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>scATAC_peak_file_path <span class="ot">&lt;-</span> <span class="st">&quot;Demo input files/scATAC peaks.txt&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>peaks <span class="ot">&lt;-</span> <span class="fu">read.table</span>(scATAC_peak_file_path, <span class="at">header =</span> F, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">head</span>(peaks)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;   V1   V2     V3     V4   V5 V6</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 1  1 chr1   9752  10693  942  *</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 2  2 chr1  15729  16627  899  *</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; 3  3 chr1  17059  17955  897  *</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; 4  4 chr1 180705 181746 1042  *</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; 5  5 chr1 182981 183730  750  *</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; 6  6 chr1 183736 184785 1050  *</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># visualize the first circuit with peak track</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">plot_circuits_with_idx</span>(data, <span class="dv">1</span>, <span class="at">gene_track =</span> F, <span class="at">peak_track =</span> T, <span class="at">peaks =</span> peaks[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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aPx7F2gSPe4mPlB38C7czN/J9n6udBftNnfd2B9btQW38OvlRpeGvnNbtYZ1ijY8xLvdm3YePX/l9nG6v9ZpA72+GNl993dgKc+Kd/Quc9fNTY21g5tChvONrhj6TmnVGtaJ2mE7qJ1YvX3efCv7rHAPbT933dzUmHtvlifJvNFVQ9/+pqk1rNO1faDR7C/OrXiw29Lyw/usg/ILbpnGquBqLFxodN15ta7/VsM6aXvZk5TfSVWtW3htnpvu6oqT1+Kzr9VRrRnb+l8ed/XrDLv8xqo1rFrfeXnhWqp/5/3ZW6Cv6zzFWLNwaZ9l91C1yau0sA0/qPJlK3y3tdd/w0/afPOWf+edr1ITie4z0ErTaGHFf2HhzTfY+jt18x1aPgGW/6Bal608jlU31qZpertbtnThelfl4I3uN9AKN+LaW7zSDVZvzWC2dO27oziwneosHUf9X9FtbtmNC9e7MvtLtMp32nugJb9lq35r84Ur3mQr1+g2LL3VbHGzfszbfrPS61/xJ1VfP651N9S7Nntp1A6jwmJ3EOjrNSuYa+e59U+B1yy98I3Llt5+tqg3rE3fbMP1r7F+vGq9oPqye7pKOyfqh1Fhwb0EWvfZIOAcKlDgrhAopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopBEopP0fB2ZIWUaehnIAAAAASUVORK5CYII=" /><!-- --></p>
<p>Now let’s put both gene and peak tracks together.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">plot_circuits_with_idx</span>(data, <span class="dv">1</span>, <span class="at">TxDb =</span> TxDb.Hsapiens.UCSC.hg38.knownGene, <span class="at">peaks =</span> peaks[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
